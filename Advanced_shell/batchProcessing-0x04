#!/bin/bash

SCRIPT="fetch_pokemon_parallel.sh"  # script to check
POKEMON_LIST=("bulbasaur" "ivysaur" "venusaur" "charmander" "charmeleon")

echo "=== Checking for Parallel Fetch Script ==="

# 1Ô∏è‚É£ Check if script contains list of Pok√©mon
for p in "${POKEMON_LIST[@]}"; do
    if ! grep -q "$p" "$SCRIPT"; then
        echo "‚ùå Pok√©mon '$p' not found in script"
        exit 1
    fi
done
echo "‚úÖ Pok√©mon list present"

# 2Ô∏è‚É£ Check if function or loop uses background processes (&)
if ! grep -Eq "\&[[:space:]]*$" "$SCRIPT"; then
    echo "‚ùå Script does not run fetch commands in the background (& missing)"
    exit 1
fi
echo "‚úÖ Script runs processes in background"

# 3Ô∏è‚É£ Check if script waits for processes to complete
if ! grep -q "wait" "$SCRIPT"; then
    echo "‚ùå Script does not use 'wait' to handle background processes"
    exit 1
fi
echo "‚úÖ Script waits for background processes to complete"

# 4Ô∏è‚É£ Optional: Check if fetch function exists
if ! grep -q "fetch_pokemon" "$SCRIPT"; then
    echo "‚ö†Ô∏è No 'fetch_pokemon' function detected (might be inline code)"
else
    echo "‚úÖ fetch_pokemon function found"
fi

echo "üéâ All checks passed for parallel process handling"
